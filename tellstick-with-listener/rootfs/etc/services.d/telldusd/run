#!/command/with-contenv bashio
s6-setuidgid root

if bashio::config.true "enable_local"; then
bashio::log.info "Local enabled. Exposing sockets to HomeAssistant..."

socat TCP-LISTEN:50800,reuseaddr,fork UNIX-CONNECT:/tmp/TelldusClient &
socat TCP-LISTEN:50801,reuseaddr,fork UNIX-CONNECT:/tmp/TelldusEvents &
fi

bashio::log.info "Loading Telldus service..."

exec /usr/sbin/telldusd --nodaemon
